<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>üí¨ BOOOMERANGS Chat</title>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }
    textarea, input { width: 100%; padding: 10px; margin: 10px 0; }
    button { padding: 10px 20px; font-weight: bold; cursor: pointer; }
    .response { margin-top: 20px; white-space: pre-wrap; background: #f3f3f3; padding: 15px; border-radius: 8px; }
  </style>
</head>
<body>
  <h1>üí¨ BOOOMERANGS Chat</h1>

  <label>üîë Access Token:</label>
  <input type="text" id="token" placeholder="–í—Å—Ç–∞–≤—å —Å–≤–æ–π —Ç–æ–∫–µ–Ω –∏–∑ chat.openai.com">

  <label>üí¨ –°–æ–æ–±—â–µ–Ω–∏–µ:</label>
  <textarea id="message" rows="4" placeholder="–ù–∞–ø–∏—à–∏ —á—Ç–æ-–Ω–∏–±—É–¥—å..."></textarea>

  <button onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>

  <div class="response" id="response"></div>

  <script>
    async function sendMessage() {
      const message = document.getElementById('message').value;
      const token = document.getElementById('token').value;
      const responseDiv = document.getElementById('response');

      responseDiv.textContent = '‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞...';

      try {
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å, —á—Ç–æ–±—ã –∑–∞–ø—Ä–æ—Å —à–µ–ª –∫ —Ç–æ–º—É –∂–µ origin
        const res = await fetch('/api/chat', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ message, accessToken: token })
        });

        const data = await res.json();

        if (data?.error) {
          responseDiv.textContent = '‚ùå –û—à–∏–±–∫–∞: ' + data.error;
        } else {
          // –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–π—Ç–∏ –æ—Ç–≤–µ—Ç ChatGPT
          const parts = data?.message?.content?.parts?.[0] || JSON.stringify(data, null, 2);
          responseDiv.textContent = 'ü§ñ –û—Ç–≤–µ—Ç:\n\n' + parts;
        }
      } catch (err) {
        responseDiv.textContent = 'üí• –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ: ' + err.message;
      }
    }
  </script>
</body>
</html>